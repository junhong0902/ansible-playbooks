---
- name: Check Status
  hosts: node1
  become: true
  gather_facts: no
  vars:
    package: 
      - httpd

  tasks:
    - name: Check status of {{ item }} service
      ansible.builtin.service_facts:
      register: service_state
      with_items:
        - "{{ package }}"

    - ansible.builtin.debug:
        var: service_state.results
        # var: service_state.ansible_facts.services["{{ package }}.service"].state
      # with_items:
      #   - "{{ package }}"

  # tasks:
  #   - name: Check status of {{ package[0] }} service
  #     ansible.builtin.service_facts:
  #     register: service_state

  #   - ansible.builtin.debug:
  #       var: service_state.ansible_facts.services["{{ package }}.service"].state